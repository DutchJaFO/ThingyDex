@page "/createcult"

@using BlazorBootstrap
@using ThingyDexer.ViewModel
@using ThingyDexer.ViewModel.Table

<PageTitle>Cult</PageTitle>

<h1>Starting a cult</h1>

<p>
    <Tooltip Title="Changes the naming convention a bit" Placement="TooltipPlacement.Left">
        <Switch Value="@Spiffy" Label="Extra weird" ValueChanged="@((newValue) => {Spiffy = newValue; if (Cultname is not null) {GenerateCultName();}})"></Switch>
    </Tooltip>
</p>

<p>
    <Tooltip Title="Show dice values" Placement="TooltipPlacement.Left">
        <Switch @bind-Value="@ShowDetails" Label="Show details"></Switch>
    </Tooltip>
</p>

<p>
    <Button Color="ButtonColor.Primary" Size="Size.Large" @onclick="GenerateCultName" TooltipTitle="Generates a new name for your cult" TooltipPlacement="TooltipPlacement.Auto">
        <Icon Name="@ThingyDexer.WASM.General.Randomizer.DiceIcon" /> Click me
    </Button>
</p>

@if (Cultname.HasValue)
{
    <Callout Type="CalloutType.Default" Heading="Cult name">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-10">
                <h4>
                    <strong>
                        @Displayname
                    </strong>
                </h4>
            </div>
        </div>
        @if (ShowDetails)
        {
            <div class="row">
                <div class="col">
                    <Grid Data="@DisplayDetails"
                          class="table table-hover table-bordered table-striped dark p8"
                  Responsive=true
                  AllowSorting=false
                  AllowFiltering=true>

                        <GridColumn TItem="RegelString" PropertyName="Index" HeaderText="Index" Filterable=false Sortable=false >
                            <Button Color="ButtonColor.Primary"
                            Disabled=false
                            Size="Size.Small"
                            Type="ButtonType.Button"
                            @onclick="((args) => OnClickWithArgs(args, context))">
                                @if (context.Equals(SelectedRegel))
                                {
                                    <Icon Name="IconName.EyeFill" />
                                }
                                else
                                {
                                    <Icon Name="IconName.Eye" />
                                }
                            </Button>

                            @context.Id
                        </GridColumn>
                        <GridColumn TItem="RegelString" PropertyName="Value" HeaderText="Value" Filterable=true Sortable=false FilterOperator="FilterOperator.Contains" >
                            @context.Name
                        </GridColumn>
                    </Grid>
                </div>
                <div class="col">
                    @if (ShowDetails && (SelectedRegel is not null))
                    {
                        <Grid Data="@SelectedRegel?.Source?.Rows(o => new SelectableRegelString() { Selected = (o.Index == SelectedRegel.Id), Id= o.Index, Name = o.Value})"
                              class="table table-striped"
                              PageSize="10" 
                              AllowPaging=true 
                              PaginationAlignment="Alignment.Start"  
                              Responsive=true                  
                              AllowFiltering=true 
                              AllowSorting=true>
                            <GridColumn TItem="SelectableRegelString" PropertyName="Selected" HeaderText="" Sortable=false FilterOperator="FilterOperator.Equals" >
                                @if (context.Selected)
                                {
                                    <Icon Name="IconName.Check2Square" Size="IconSize.x2"></Icon>
                                }
                                else
                                {
                                    <Icon Name="IconName.Square" Size="IconSize.x2"></Icon>
                                }
                            </GridColumn>
                            <GridColumn TItem="SelectableRegelString" PropertyName="Id" HeaderText="Id" IsDefaultSortColumn=true SortDirection="SortDirection.Ascending" SortKeySelector="@((o) => o.Id)">
                                @if (context.Selected)
                                {
                                    <strong>@context.Id</strong>
                                }
                                else
                                {
                                    @context.Id
                                }
                            </GridColumn>
                            <GridColumn TItem="SelectableRegelString" PropertyName="Name" HeaderText="Value" Sortable=true SortKeySelector="@((o) => o.Name)">
                                @if (context.Selected)
                                {
                                    <strong>@context.Name</strong>
                                }
                                else
                                {
                                    @context.Name
                                }
                            </GridColumn>
                        </Grid>
                    }
                </div>
            </div>
        }
        <br />
        <p>@($"{TimeStamp:dd-MM-yyyy HH:mm:ss}")</p>
    </Callout>
}
else
{
    <Callout Type="CalloutType.Tip">
        <h4>Try clicking the button ...</h4>
    </Callout>
}



